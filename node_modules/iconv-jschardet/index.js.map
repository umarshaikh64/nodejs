{"version":3,"file":"index.js","sourceRoot":"","sources":["index.ts"],"names":[],"mappings":"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","sourcesContent":["import iconvLite, { encodingExists } from 'iconv-lite';\nimport jschardet from 'jschardet';\nimport console from 'debug-color2/logger';\n\n//import encodingExists = iconvLite.encodingExists;\n\nexport * from './lib/const';\nexport * from './encoding';\n\nimport { codec_data, disableCodecDataWarn } from './encoding';\nimport { IDetectData, vEncoding } from './lib/const';\nimport { codecDataNameToUpperCase, CODEC_DATA_NAME_TO_UPPER_CASE, ENUM_NODE_ENCODING } from './lib/const';\n\nexport {\n\tencodingExists,\n\n\t/*\n\tcodec_data,\n\t_enc,\n\tisNodeEncoding,\n\tNodeEncoding,\n\t*/\n\n\tjschardet,\n\ticonvLite,\n\n\tdisableCodecDataWarn,\n}\n\n/**\n * 停用編碼檢測警告\n */\nexport function skipDecodeWarning(bool: boolean = true): boolean\n{\n\t// @ts-ignore\n\treturn iconvLite.skipDecodeWarning = bool;\n}\n\n/**\n * 將輸入內容轉換為 Buffer\n */\nexport function BufferFrom(str, encoding: vEncoding = 'utf8', from?: vEncoding): Buffer\n{\n\tlet data;\n\n\tif (from)\n\t{\n\t\tdata = Buffer.from(str, from as BufferEncoding);\n\t}\n\telse\n\t{\n\t\tdata = str;\n\t}\n\n\tdata = decode(data);\n\tlet buf = iconvLite.encode(data, encoding);\n\n\treturn buf;\n}\n\n/**\n * 檢測輸入內容編碼\n */\nexport function detect(str, plus?: boolean)\n{\n\tlet ret = jschardet.detect(str) as any as IDetectData;\n\n\tif (plus)\n\t{\n\t\tlet cd = codec_data(ret.encoding);\n\t\tif (cd)\n\t\t{\n\t\t\tif (cd.name)\n\t\t\t{\n\t\t\t\tret.name = cd.name;\n\t\t\t}\n\n\t\t\tret.id = cd.id;\n\t\t}\n\t}\n\n\tif (!ret.name)\n\t{\n\t\tret.name = ret.encoding;\n\t}\n\n\treturn ret;\n}\n\n/**\n * 檢測輸入內容編碼並且轉換為 字串\n */\nexport function decode(str, from: vEncoding = null): string\n{\n\tlet c;\n\n\tif (!str.length)\n\t{\n\t\treturn '';\n\t}\n\n\tif (!from)\n\t{\n\t\tc = detect(str);\n\t\tfrom = c.encoding;\n\t}\n\n\tlet data;\n\n\tlet cd = codec_data(from);\n\n\tlet key: string;\n\n\tif (cd && cd.name && !cd.not)\n\t{\n\t\tkey = cd.name;\n\t}\n\telse\n\t{\n\t\tkey = from;\n\t}\n\n\tswitch (codecDataNameToUpperCase(key))\n\t{\n\t\t//case 'BIG5':\n\t\t//case 'GBK':\n\t\t//case 'GB2312':\n\t\t//case 'UTF-16LE':\n\t\t//case 'UTF-16BE':\n\t\t//case 'EUC-JP':\n\t\t//case 'SHIFT_JIS':\n\t\tcase CODEC_DATA_NAME_TO_UPPER_CASE.BIG5:\n\t\tcase CODEC_DATA_NAME_TO_UPPER_CASE.GBK:\n\t\tcase CODEC_DATA_NAME_TO_UPPER_CASE.GB2312:\n\t\tcase CODEC_DATA_NAME_TO_UPPER_CASE.UTF_16_LE:\n\t\tcase CODEC_DATA_NAME_TO_UPPER_CASE.UTF_16_BE:\n\t\tcase CODEC_DATA_NAME_TO_UPPER_CASE.EUC_JP:\n\t\tcase CODEC_DATA_NAME_TO_UPPER_CASE.SHIFT_JIS:\n\t\t\tdata = iconvLite.decode(str, from);\n\t\t\tbreak;\n\t\t//case 'ASCII':\n\t\t//case 'UTF-8':\n\t\tcase CODEC_DATA_NAME_TO_UPPER_CASE.ASCII:\n\t\tcase CODEC_DATA_NAME_TO_UPPER_CASE.UTF_8:\n\t\t\tdata = str;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tc = c || detect(str);\n\n\t\t\t// @ts-ignore\n\t\t\tif (!iconvLite.skipDecodeWarning)\n\t\t\t{\n\t\t\t\tconsole.warn('decode', from, c);\n\t\t\t}\n\n\t\t\t//data = str;\n\t\t\tdata = iconvLite.decode(str, from);\n\t\t\tbreak;\n\t}\n\n\treturn data;\n}\n\n/**\n * 檢測輸入內容編碼並且轉換為 Buffer\n */\nexport function encode(str, to: vEncoding = ENUM_NODE_ENCODING.UTF8, from: vEncoding = null): Buffer\n{\n\tlet buf = BufferFrom(str, ENUM_NODE_ENCODING.UTF8);\n\n\t// @ts-ignore\n\treturn iconvLite.encode(buf, to);\n}\n\nexport default exports as typeof import('./index');\n"]}
{"version":3,"file":"index.js","sourceRoot":"","sources":["index.ts"],"names":[],"mappings":"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","sourcesContent":["\nimport { characters } from './lib/data';\nexport { characters } from './lib/data';\n\nexport function chinese_parseInt(str: string, radix?: number)\n{\n\tlet charVal: any;\n\tlet result = parseInt(str, radix);\n\tif (!isNaN(result)) return result;\n\tif (typeof str !== \"string\") return NaN;\n\n\tstr = str.replace(/[\\s　]+/g, \"\");\n\tconst negative = /^[負负-]/.test(str);\n\tif (negative) str = str.substr(1);\n\n\tresult = 0;\n\tlet partialSum = 0; ///< 不到一萬的部分\n\tlet digit = -1;     ///< 個位數，預設為 -1 以區分有無\"零\"的出現\n\n\tfor (let i = 0; i < str.length; ++i)\n\t{\n\t\tcharVal = characters[str.charAt(i)]; ///< 暫存字元代表的數值\n\t\tif (charVal === undefined) return NaN; // 有任何不認得的字，直接 NaN\n\t\tif (charVal < 10)\n\t\t{\n\t\t\tdigit = (digit == -1)\n\t\t\t\t? charVal\n\t\t\t\t: digit * 10 + charVal  // ex. 零五、二五六萬\n\t\t\t;\n\t\t}\n\t\telse if (charVal < 1e+4)\n\t\t{\n\t\t\tif (digit == -1) digit = 1;\n\t\t\tif (i > 1 && digit == 0 && characters[str.charAt(i - 2)] != 100)\n\t\t\t{\n\t\t\t\tdigit = 1;\n\t\t\t} // 處理\"一千零十一\"；搜尋\"千零十\"的確是出現過的。\n\t\t\tpartialSum += digit * charVal;\n\t\t\tdigit = -1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (digit != -1) partialSum += digit;\n\t\t\tif (i && characters[str.charAt(i - 1)] >= 1e+4) // 為了\"四萬萬五千萬\"\n\t\t\t{\n\t\t\t\tresult *= characters[str.charAt(i)];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult += partialSum * charVal;\n\t\t\t}\n\t\t\tpartialSum = 0;\n\t\t\tdigit = -1;\n\t\t}\n\t}\n\tif (digit > 0)\n\t{\n\t\tif (str.length > 1)\n\t\t{  // 為了處理\"二十四萬二\"、\"二百五\"等\n\t\t\tcharVal = characters[str.charAt(str.length - 2)];\n\t\t\tif (charVal < 100)\n\t\t\t{\n\t\t\t\tpartialSum += digit;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcharVal /= charVal.toString().charAt(0);  // 把「皕」轉成100\n\t\t\t\tpartialSum += digit * (charVal / 10);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpartialSum += digit;\n\t\t}\n\t}\n\tresult += partialSum;\n\n\tif (negative) result *= -1;\n\n\treturn result;\n}\n\nexport default chinese_parseInt\n"]}